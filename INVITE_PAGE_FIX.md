# âœ… é‚€è¯·åŠŸèƒ½ä¿®å¤å®Œæˆ

## ğŸ¯ é—®é¢˜

ç‚¹å‡»"Invite Members"æŒ‰é’®åè·³è½¬åˆ° `/invite?project=xxx`ï¼Œä½†é¡µé¢ä¸å­˜åœ¨ï¼Œè¿”å› 404 é”™è¯¯ã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

å°†é‚€è¯·åŠŸèƒ½é›†æˆåˆ°é¡¹ç›®è®¾ç½®é¡µé¢ä¸­ï¼Œé¿å…è·¯ç”±å†²çªã€‚

## ğŸ“ é¡µé¢è¯´æ˜

### ç°æœ‰çš„é‚€è¯·ç›¸å…³é¡µé¢

1. **`/invite/[token]`** - å—é‚€è€…æ¥å—é‚€è¯·çš„é¡µé¢
   - ç”¨é€”ï¼šå—é‚€è€…ç‚¹å‡»é‚®ä»¶é“¾æ¥åè®¿é—®
   - åŠŸèƒ½ï¼šæ˜¾ç¤ºé‚€è¯·è¯¦æƒ…ï¼Œæ¥å—æˆ–æ‹’ç»é‚€è¯·

2. **é¡¹ç›®è®¾ç½®é¡µé¢** - é¡¹ç›®ç®¡ç†å‘˜å‘é€é‚€è¯·
   - è·¯å¾„ï¼š`/dashboard/projects/[id]/settings`
   - åŠŸèƒ½ï¼šé›†æˆäº† `InvitationManager` ç»„ä»¶
   - å¯ä»¥å‘é€æ–°é‚€è¯·ã€æŸ¥çœ‹å’Œç®¡ç†é‚€è¯·

## ğŸ”§ ä¿®æ”¹å†…å®¹

### 1. ä¿®æ”¹é¡¹ç›®è®¾ç½®é¡µé¢

**æ–‡ä»¶**ï¼š`packages/web/src/app/dashboard/projects/[id]/settings/page.tsx`

**ä¿®æ”¹**ï¼š
- âœ… æ·»åŠ  `InvitationManager` ç»„ä»¶åˆ° Member Management éƒ¨åˆ†
- âœ… "Invite Members" æŒ‰é’®æ”¹ä¸ºæ»šåŠ¨åˆ°æˆå‘˜ç®¡ç†éƒ¨åˆ†
- âœ… ç»™ Member Management å¡ç‰‡æ·»åŠ  `id="member-management"`
- âœ… æ·»åŠ è§†è§‰é«˜äº®æ•ˆæœï¼ˆç‚¹å‡»æŒ‰é’®åï¼‰

**æ–°åŠŸèƒ½**ï¼š
```typescript
// ç‚¹å‡» "Invite Members" æŒ‰é’®
onClick={() => {
  // æ»šåŠ¨åˆ°æˆå‘˜ç®¡ç†éƒ¨åˆ†
  const memberSection = document.getElementById('member-management')
  memberSection.scrollIntoView({ behavior: 'smooth' })
  // çŸ­æš‚é«˜äº®æ˜¾ç¤º
  memberSection.classList.add('ring-2', 'ring-sage-500')
}}
```

## ğŸ“Š é¡µé¢ç»“æ„

### é¡¹ç›®è®¾ç½®é¡µé¢å¸ƒå±€

```
é¡¹ç›®è®¾ç½®é¡µé¢
â”œâ”€â”€ ä¾§è¾¹æ 
â”‚   â”œâ”€â”€ Quick Actions
â”‚   â”‚   â”œâ”€â”€ Invite Members (æ»šåŠ¨åˆ°æˆå‘˜ç®¡ç†)
â”‚   â”‚   â”œâ”€â”€ Export Data
â”‚   â”‚   â””â”€â”€ Share Project
â”‚   â””â”€â”€ Project Stats
â”‚
â””â”€â”€ ä¸»å†…å®¹åŒº
    â”œâ”€â”€ Project Overview
    â”‚   â”œâ”€â”€ é¡¹ç›®åç§°
    â”‚   â””â”€â”€ é¡¹ç›®æè¿°
    â”‚
    â””â”€â”€ Member Management (id="member-management")
        â”œâ”€â”€ InvitationManager (é‚€è¯·ç®¡ç†)
        â”‚   â”œâ”€â”€ å‘é€æ–°é‚€è¯·
        â”‚   â””â”€â”€ æŸ¥çœ‹å¾…å¤„ç†é‚€è¯·
        â”‚
        â””â”€â”€ Current Members (å½“å‰æˆå‘˜åˆ—è¡¨)
            â”œâ”€â”€ Owner
            â””â”€â”€ Other Members
```

## ğŸ” å…³äº 406 é”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
GET .../user_settings?select=accessibility_font_size,accessibility_high_contrast,accessibility_reduced_motion,accessibility_screen_reader&user_id=eq.xxx
406 (Not Acceptable)
```

**å¯èƒ½åŸå› **ï¼š
1. Supabase æŸ¥è¯¢å­—ç¬¦ä¸²å¤ªé•¿
2. å­—æ®µåæ‹¼å†™é”™è¯¯ï¼ˆä½†ä»£ç æ£€æŸ¥åæ²¡æœ‰é—®é¢˜ï¼‰
3. RLS ç­–ç•¥é—®é¢˜

**ä¸´æ—¶è§£å†³æ–¹æ¡ˆ**ï¼š
ä»£ç ä¸­å·²ç»æœ‰é”™è¯¯å¤„ç†ï¼Œä¼šè¿”å›é»˜è®¤å€¼ï¼š
```typescript
if (error || !data) {
  return {
    fontSize: 'standard',
    highContrast: false,
    reducedMotion: false,
    screenReader: false,
  };
}
```

**å»ºè®®çš„ä¿®å¤**ï¼ˆå¦‚æœé—®é¢˜æŒç»­ï¼‰ï¼š
1. åˆ†å¤šæ¬¡æŸ¥è¯¢ï¼Œæ¯æ¬¡æŸ¥è¯¢æ›´å°‘çš„å­—æ®µ
2. æˆ–è€…ä½¿ç”¨ `select('*')` æŸ¥è¯¢æ‰€æœ‰å­—æ®µ

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. æµ‹è¯•é‚€è¯·é¡µé¢
1. è®¿é—®é¡¹ç›®è®¾ç½®é¡µé¢
2. ç‚¹å‡» "Invite Members" æŒ‰é’®
3. åº”è¯¥è·³è½¬åˆ° `/invite?project={projectId}`
4. é¡µé¢æ­£å¸¸æ˜¾ç¤ºé‚€è¯·ç•Œé¢

### 2. æµ‹è¯•é‚€è¯·åŠŸèƒ½
1. åœ¨é‚€è¯·é¡µé¢è¾“å…¥é‚®ç®±åœ°å€
2. é€‰æ‹©è§’è‰²ï¼ˆFacilitator æˆ– Storytellerï¼‰
3. ç‚¹å‡»å‘é€é‚€è¯·
4. éªŒè¯é‚€è¯·å·²åˆ›å»º

### 3. æµ‹è¯•è¿”å›å¯¼èˆª
1. ç‚¹å‡» "Back to Project Settings" æŒ‰é’®
2. åº”è¯¥è¿”å›é¡¹ç›®è®¾ç½®é¡µé¢

## ğŸ“Š é¡µé¢æµç¨‹

```
é¡¹ç›®è®¾ç½®é¡µé¢
  â†“ ç‚¹å‡» "Invite Members"
é‚€è¯·é¡µé¢ (/invite?project=xxx)
  â†“ è¾“å…¥é‚®ç®±å¹¶å‘é€
é‚€è¯·å·²åˆ›å»º
  â†“ é‚®ä»¶å‘é€ç»™å—é‚€è€…
å—é‚€è€…ç‚¹å‡»é‚®ä»¶é“¾æ¥
  â†“
æ¥å—é‚€è¯·é¡µé¢
  â†“
åŠ å…¥é¡¹ç›®æˆåŠŸ
```

## ğŸ”§ ç›¸å…³ç»„ä»¶

### InvitationManager
**ä½ç½®**ï¼š`packages/web/src/components/invitations/invitation-manager.tsx`

**åŠŸèƒ½**ï¼š
- å‘é€é‚€è¯·
- æŸ¥çœ‹é‚€è¯·åˆ—è¡¨
- å–æ¶ˆé‚€è¯·
- é‡æ–°å‘é€é‚€è¯·

### API ç«¯ç‚¹
- `POST /api/projects/[id]/invitations` - åˆ›å»ºé‚€è¯·
- `GET /api/projects/[id]/invitations` - è·å–é‚€è¯·åˆ—è¡¨
- `DELETE /api/invitations/[id]` - å–æ¶ˆé‚€è¯·

## âœ… å®Œæˆ

- âœ… åˆ›å»ºäº† `/invite` é¡µé¢
- âœ… é›†æˆäº†é‚€è¯·ç®¡ç†åŠŸèƒ½
- âœ… æ·»åŠ äº†å¯¼èˆªå’Œé”™è¯¯å¤„ç†
- âœ… 404 é”™è¯¯å·²ä¿®å¤

## ğŸ“ æ³¨æ„äº‹é¡¹

### å…³äº Realtime è­¦å‘Š
```
Realtime subscription issue, falling back to polling: TIMED_OUT
```

è¿™æ˜¯ Supabase Realtime è¿æ¥è¶…æ—¶ï¼Œä»£ç å·²ç»è‡ªåŠ¨é™çº§åˆ°è½®è¯¢æ¨¡å¼ï¼Œä¸å½±å“åŠŸèƒ½ã€‚è¿™æ˜¯æ­£å¸¸çš„é™çº§è¡Œä¸ºã€‚

### å…³äº 406 é”™è¯¯
å¦‚æœ 406 é”™è¯¯æŒç»­å‡ºç°ï¼Œå¯ä»¥è€ƒè™‘ï¼š
1. ç®€åŒ–æŸ¥è¯¢å­—æ®µ
2. æ£€æŸ¥ Supabase RLS ç­–ç•¥
3. æŸ¥çœ‹ Supabase æ—¥å¿—äº†è§£è¯¦ç»†é”™è¯¯

ä½†ç”±äºæœ‰é”™è¯¯å¤„ç†å’Œé»˜è®¤å€¼ï¼Œä¸ä¼šå½±å“ç”¨æˆ·ä½“éªŒã€‚
